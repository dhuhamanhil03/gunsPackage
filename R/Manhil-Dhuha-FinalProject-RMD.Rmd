---
title: "Manhil-Dhuha-Final-Project"
author: "Dhuha Manhil"
date: "2022-12-06"
output: pdf_document
---

For this final project, I chose to perform statistical analyses on a 
data set called 'Guns'. The data set takes information from 51 states 
(including District of Columbia) and tracks their relevant data over 
23 years, meaning in total there are 1,173 observations, 23 for each 
state. The data was collected from a population of 100,000 in each state. 
Furthermore, the data tracked over a 23 year period, from 1977 to 1999.

There are 13 separate variables that will be used to form some 
conclusions on gun violence and if more guns equals less crime. 
I will be specifically focusing on the state of Virginia, but will 
conduct some additional tests to see how Virginia compares with 
another state on the West Coast.

I chose this specific data set because of my frustration when watching
the news in the United States and seeing more and more shootings 
take place. I would like to see how different gun violence/crime 
was from 1977 to 1999 and compare it to now, seeing if it was less or more.

```{r message = FALSE}
library(AER)
library(tidyverse)
library(dplyr)
library(readxl)
library(ggplot2)
library(scales)
```

Creating a function to read in any .xlsx data.
```{r}
readingInData <- function(dataFile) {
  dataFile <- read_xlsx(dataFile)
  print(dataFile)
}
```

Using the function created above to read in the data set.
```{r}
gunsDataSet <- readingInData("Guns.xlsx")
```

Creating a subset to contain only Virginia data.
```{r}
virginiaData <- subset(gunsDataSet, stateid == 46, 
                select = c(year, vio, mur, rob, incarc_rate, pb1064, 
                pw1064, pm1029, pop, avginc, density, stateid, shall))
print(virginiaData)
```

Summarizing data set.
```{r}
summarizeFunction <- function(dataSet) {
  summaryOfSet <- summary(dataSet)
  print(summaryOfSet)
}
```

When we run this code below, we can see a summary of the 14
variables that are in the Virginia data set. We can specifically 
focus on the vio, mur, and rob variables, as they can show us 
some descriptive statistics. We can see that the average for vio
is higher than the average for both mur and rob, which can signify
the severity of the level of violence that Virginia endured from 
the years 1977 to 1999.
```{r}
summarizeFunction(virginiaData)
```

Creating a subset of just Virginia Years.
```{r}
virginiaYears <- subset(virginiaData, select = c(year))
print(virginiaYears)
```

Correlation function.
```{r}
correlationFunction <- function(x, y) {
  correlationOfVariables = cor(x, y, method = 'pearson')
  print(correlationOfVariables)
}
```

Simple linear regression function.
```{r}
plot(virginiaData$rob ~ virginiaData$avginc, data = virginiaData, pch = 16)
linearModel <- lm(rob ~ avginc, data = virginiaData)
summary(linearModel)
plot(rob ~ avginc, data = virginiaData, pch = 16)
abline(linearModel)
```

Visualization functions.
```{r}
bargraphPlot <- function(virginiaYears, yaxis, yaxisLabel, title) {
  plotOfData <- ggplot(virginiaData, aes(x = virginiaYears$year, y = yaxis)) +
  geom_bar(stat = "identity", color = "maroon", fill = "peachpuff") + theme_light() +
  ylab(yaxisLabel) + xlab("Years (1900's)") + 
  theme(legend.position = "none") + ggtitle(title) + theme(plot.title = element_text(hjust = 0.5))
  print(plotOfData)
}
bargraphPlot(virginiaYears, virginiaData$vio, "Violence Crime Rate", 
             "Violence Crime Rate vs Years in the State of Virginia")
```

```{r}
virginiaData$totalCrime <- virginiaData$vio + virginiaData$rob + virginiaData$mur

histogramPlot <- function(dataSet, xaxis, xaxisLabel, yaxisLabel, title) {
  ggplot(dataSet) +
  aes(x = xaxis) +
  geom_histogram(bins = 11L, fill = "violet") +
  labs(x = xaxisLabel, y = yaxisLabel, 
  title = title) + theme(plot.title = element_text(hjust = 0.5))
}
histogramPlot(virginiaData, virginiaData$totalCrime, 
"Total Crime Rate of Murders, Violence, and Robbery", "Frequency", 
"Histogram of Total Crime Rates")
```

```{r}
scatterPlot <- function(dataSet, xaxis, yaxis, xaxisLabel, yaxisLabel, title) {
ggplot(dataSet) +
  aes(x = xaxis, y = yaxis) +
  geom_point(size = 3L, colour = "khaki") +
  labs(x = xaxisLabel, y = yaxisLabel, title = title) + 
  facet_wrap(vars(shall)) + theme(plot.title = 
  element_text(hjust = 0.5))
}
scatterPlot(virginiaData, virginiaData$totalCrime, virginiaData$incarc_rate, "Total Crime",
                "Incarceration Rate", "Total Crime vs Incarceration Rate")
```

```{r}
par(mfrow = c(1,2))
boxPlot <- function(dataSet, xaxis, yaxis, xaxisLabel, yaxisLabel, title) {
ggplot(dataSet) + aes(x = xaxis, y = yaxis, fill = xaxis) +
  geom_boxplot() +
  labs(x = xaxisLabel, y = yaxisLabel, title = title) + theme(plot.title = 
  element_text(hjust = 0.5)) + theme(legend.position = "none")
}
boxPlot(virginiaData, virginiaData$shall == 1, virginiaData$totalCrime, "Shall Law", "Total Crime",
        "Total Crime vs Shall Law")
```
